{"version":3,"sources":["meteor://ðŸ’»app/server/startup/loadModels.js","meteor://ðŸ’»app/server/startup/loadUsers.js","meteor://ðŸ’»app/server/accountrole.js","meteor://ðŸ’»app/server/modelsPublish.js","meteor://ðŸ’»app/model/models.js"],"names":[],"mappings":"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","file":"/app.js","sourcesContent":["Meteor.startup(function() {\n\tif(Levels.find().count() === 0)\n\t{\n\t\t\n\t\tvar levels = [\n\t\t\t{ 'name' : \"Visitor Level\", 'value' : \"l0\" },\n\t\t\t{ 'name' : \"INTRO-SSI Intro to Scuba\", 'value' : \"l1\" },\n        \t{ 'name' : \"KIDS-SSI Scuba Rangers\", 'value' : \"l2\" },\n        \t{ 'name' : \"LEVEL1-Open Water\", 'value' : \"l3\" },\n        \t{ 'name' : \"LEVEL2-Specialty Driver\", 'value' : \"l4\" },\n        \t{ 'name' : \"LEVEL3-SSI Advanced Open Water\", 'value' : \"l5\" },\n        \t{ 'name' : \"LEVEL4-SSI Master Driver\", 'value' : \"l6\" },\n        \t{ 'name' : \"LEVEL5-SSI Century Driver\", 'value' : \"l7\" },\n        \t{ 'name' : \"LEVEL6-SSI\", 'value' : \"l8\" },\n        \t{ 'name' : \"LEVEL7-SSI\", 'value' : \"l9\" },\n        \t{ 'name' : \"LEVEL8-SSI\", 'value' : \"l10\" },\n        \t{ 'name' : \"LEVEL9-SSI Gold 500 Diver\", 'value' : \"l11\" },\n        \t{ 'name' : \"LEVEL10-SSI Platinum 1000 Driver\", 'value' : \"l12\" },\n        \t{ 'name' : \"PRO-SSI Platinum 5000 Driver\", 'value' : \"l13\" },\n        \t{ 'name' : \"DIVECON-SSI Dive Control Speciallist\", 'value' : \"l14\" },\n        \t{ 'name' : \"INSTRUCTOR-SSI Open Water Instructor\", 'value' : \"l15\" }\n\t\t];\n\n\t\tfor (var i = 0; i < levels.length; i++) \n\t\t{\n\t\t\tLevels.insert({\n\t\t\t\tname : levels[i].name, \n\t\t\t\tvalue : levels[i].value\n\t\t\t});\n\t\t}\n\n\t\tif(Levels.find().count() !== 0)\n\t\t\tconsole.log('levels are created!');\n\t}\n});","Meteor.startup(function() {\n\tif(Meteor.users.find().count() === 0)\n\t{\n\n\t\tvar id = Accounts.createUser({\n\t\t\tusername: 'admin',\n\t\t\tpassword: '123456',\n\t\t\tprofile: {name: 'Admin', surname: 'Surname'}\n\t\t});\n\n\t\tif(Meteor.users.find().count !==0)\n\t\t{\n\t\t\tconsole.log('New admin created!');\n\t\t}\n\t}\n});","//default role for user \nAccounts.onCreateUser(function(options, user){\n\tif(options.profile)\n\t{\n\t\tvar AdminRoles = ['logbook', 'activity', 'role'];\n\n\t\tif(user.username === \"admin\")\n\t\t\tuser.roles = AdminRoles;\n\t\telse\n\t\t{\n\t\t\tuser.roles = ['logbook'];\n\t\t\toptions.profile.level = 'l0';\n\t\t}\n\t\tuser.profile = options.profile;\n\t}\n\n\treturn user;\n});","//publish all levels\nMeteor.publish(\"AllLevels\", function(){\n\treturn Levels.find();\n});\n\n//publish all activities for adding, editing and removing according to user role\nMeteor.publish(\"AllActivities\", function(options, search){\n\nif (search == null) \n\t{\n\t\tsearch = '';\n\t}\n\n\tvar today = new Date();\n\n\tconst selector = {\n\t\t'name' : {'$regex' : '.*' + search || '' + '.*', '$options' : 'i'},\n\t\t$or: [{\n\t\t\t$and: [\n\t\t\t\t{show: true},\n\t\t\t\t{show : {$exists: true}},\n\t\t\t\t{date : {$gte: today}}\n\t\t\t]\n\t\t}]\n\t};\n\n\tconst selector_date = {\n\t\t$or: [{\n\t\t\t$and: [{date: {$gte: today}}]\n\t\t}]\n\t};\n\n\tif(Roles.userIsInRole(this.userId, ['activity']))\n\t{\n\t\tCounts.publish(this, 'numberOfActivities', Activities.find({\n\t\t\t'name' : {'$regex' : '.*' + search || '' + '.*', '$options' : 'i'}\n\t\t}), {noReady: true});\n\n\t\treturn Activities.find({\n\t\t\t'name' : {'$regex' : '.*' + search || '' + '.*', '$options' : 'i'}\n\t\t},options);\n\t}\n\telse\n\t{\n\t\tCounts.publish(this, 'numberOfActivities', Activities.find(selector), {noReady: true});\n\n\t\treturn Activities.find(selector, options);\n\t}\n});\n\n//publish all logbooks belongs to current user\nMeteor.publish(\"AllLogbooks\", function(options, search){\n\tif (search == null) \n\t{\n\t\tsearch = '';\n\t}\n\n\tconst selector = {\n\t\t'name' : {'$regex' : '.*' + search || '' + '.*', '$options' : 'i'},\n\t\t$or: [\n\t\t\t{$and: [\n\t\t\t\t{owner : this.userId},\n\t\t\t\t{owner : {$exists: true}}\n\t\t\t]}\n\t\t]\n\t};\n\n\tif(Roles.userIsInRole(this.userId, ['logbook']))\n\t{\n\t\tCounts.publish(this, 'numberOfLogbooks', Logbooks.find(selector), {noReady: true});\n\n\t\treturn Logbooks.find(selector, options);\n\t}\n});\n\n//publish all user (not admin)\nMeteor.publish(\"AllUsers\", function(options, search){\n\tif (search == null) \n\t{\n\t\tsearch = '';\n\t}\n\n\tconst selector = {\n\t\t'profile.name' : {'$regex' : '.*' + search || '' + '.*', '$options' : 'i'}\n\t};\n\n\tif(Roles.userIsInRole(this.userId, ['role']))\n\t{\n\t\tCounts.publish(this, 'numberOfUsers', Meteor.users.find(selector), {noReady: true});\n\n\t\treturn Meteor.users.find(selector, options);\n\t}\n});\n\nMeteor.publish(\"Profile\", function(){\n\treturn Meteor.users.find({_id: this.userId}, {fields: {profile: 1}});\n});","//levels for divers\nLevels = new Mongo.Collection(\"levels\");\n\n//atributes: name, description, place, date, time\nActivities = new Mongo.Collection(\"activities\");\n\nActivities.allow({\n\tremove: function(userId, activity)\n\t{\n\t\tif(Roles.userIsInRole(userId, ['activity']) && activity.owner === userId)\n\t\t\treturn true;\n\t},\n\t\n\tinsert: function(userId, activity)\n\t{\n\t\tif(Roles.userIsInRole(userId, ['activity']) && activity.owner === userId)\n\t\t\treturn true;\n\t},\n\t\n\tupdate: function(userId, activity)\n\t{\n\t\tif(Roles.userIsInRole(userId, ['activity']) && activity.owner === userId)\n\t\t\treturn true;\n\t}\n});\n\n\n//atributes: name, body, date, time, Duration ...\nLogbooks = new Mongo.Collection(\"logbooks\");\n\nLogbooks.allow({\n\tremove: function(userId, logbook)\n\t{\n\t\tif(Roles.userIsInRole(userId, ['logbook']) && logbook.owner === userId)\n\t\t\treturn true;\n\t},\n\t\n\tinsert: function(userId, logbook)\n\t{\n\t\tif(Roles.userIsInRole(userId, ['logbook']) && logbook.owner === userId)\n\t\t\treturn true;\n\t},\n\t\n\tupdate: function(userId, logbook)\n\t{\n\t\tif(Roles.userIsInRole(userId, ['logbook']) && logbook.owner === userId)\n\t\t\treturn true;\n\t}\n});\n\nMeteor.users.allow({\n\tupdate: function(userId)\n\t{\n\t\t//for changing role\n\t\tif(Roles.userIsInRole(userId, ['role']))\n\t\t\treturn true;\n\n\t\t//for editing profile\n\t\tif(Meteor.userId() === userId)\n\t\t\treturn true;\n\t}\n});"]}